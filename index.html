<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday</title>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Noto+Sans+TC:wght@300;500&display=swap" rel="stylesheet">
    
    <style>
        /* --- ä¿æŒä½ åŸæœ¬å–œæ­¡çš„ CSS è¨­å®š --- */
        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            overflow: hidden;
            display: flex;
            height: 100vh;
            font-family: 'Noto Sans TC', sans-serif;
        }

        canvas {
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
        }

        /* å·¦å´æ–‡å­—å€å¡Š (ä¿æŒä¸è®Š) */
        #text-container {
            position: absolute;
            z-index: 2;
            top: 50%;
            left: 10%;
            transform: translateY(-50%);
            color: #fff;
            text-align: left;
            pointer-events: none;
            opacity: 0;
            transition: opacity 2s ease-in;
            max-width: 400px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .title {
            font-family: 'Great Vibes', cursive;
            font-size: 4rem;
            color: #FF69B4;
            margin-bottom: 15px;
            text-shadow: 0 0 15px rgba(255, 105, 180, 0.8);
        }

        .message {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #eee;
        }
        
        .show-text {
            opacity: 1 !important;
        }
    </style>
</head>
<body>

    <div id="text-container">
        <div class="title">Happy Birthday</div>
        <div class="message">
            Hey You,<br>
            Happy Birthday! <span style="color:#ff69b4">ğŸˆ</span><br>
            May God bless you <span style="color:#00ffff">ğŸ€</span><br>
            And give you many happiness.<br>
            Just saying... you're pretty awesome <span style="color:#ff4500">â¤ï¸</span><br>
            Sending good vibes and maybe a wink ğŸ˜‰<br>
            Hope you have a great day today! <span style="color:#ff1493">ğŸ’•</span>
        </div>
    </div>

    <canvas id="canvas"></canvas>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        // åƒè€ƒå½±ç‰‡ä¸­çš„ç¹½ç´›é…è‰²
        const colors = ['#FF69B4', '#FF1493', '#FFB6C1', '#FFD700', '#FFA500', '#FF4500', '#DA70D6', '#FFFFFF'];

        // è¨­å®šåƒæ•¸
        const config = {
            heartWidth: 300,      // æ„›å¿ƒæ¨¹å† çš„å¯¬åº¦
            heartHeight: 280,     // æ„›å¿ƒæ¨¹å† çš„é«˜åº¦
            leafCount: 400,       // è‘‰å­ç¸½æ•¸é‡ (è¶Šå¤šè¶Šå¯†)
            trunkColor: '#FFC0CB',// ç²‰è‰²æ¨¹å¹¹
            growSpeed: 3,         // æ¨¹å¹¹ç”Ÿé•·é€Ÿåº¦
            bloomSpeed: 10        // é–‹èŠ±é€Ÿåº¦ (ä¸€æ¬¡é•·å¹¾ç‰‡)
        };

        let treeData = {
            trunk: { height: 0, maxHeight: window.innerHeight * 0.45, width: 12 },
            branches: [],
            leaves: [],
            bloomedCount: 0,
            finished: false
        };

        // åˆå§‹åŒ–
        function init() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            // 1. æº–å‚™æ¨¹å¹¹ä½ç½® (åå³)
            const rootX = canvas.width * 0.75; 
            const rootY = canvas.height;

            // 2. é å…ˆè¨ˆç®—å¥½æ‰€æœ‰è‘‰å­çš„ä½ç½® (ä½¿ç”¨å¿ƒå½¢å…¬å¼)
            // å…¬å¼ï¼šx = 16sin^3(t), y = 13cos(t) - 5cos(2t) - 2cos(3t) - cos(4t)
            for (let i = 0; i < config.leafCount; i++) {
                // éš¨æ©Ÿåœ¨å¿ƒå½¢å…§éƒ¨å–é»
                let valid = false;
                let lx, ly;
                while (!valid) {
                    // ç°¡å–®çš„æ‹’çµ•æ¡æ¨£æ³•ä¾†å¡«å……å¿ƒå½¢
                    const t = Math.random() * Math.PI * 2;
                    // éš¨æ©ŸåŠå¾‘ç¸®æ”¾ï¼Œè®“è‘‰å­åˆ†ä½ˆåœ¨å…§éƒ¨è€Œä¸åªæ˜¯é‚Šç·£
                    const r = Math.sqrt(Math.random()); 
                    
                    // æ¨™æº–å¿ƒå½¢åº§æ¨™ (-16~16, -17~13)
                    const hx = 16 * Math.pow(Math.sin(t), 3);
                    const hy = -(13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t));
                    
                    // ç¸®æ”¾ä¸¦å®šä½åˆ°æ¨¹é ‚
                    lx = rootX + hx * (config.heartWidth / 35) * r;
                    ly = (rootY - treeData.trunk.maxHeight - config.heartHeight * 0.4) + hy * (config.heartHeight / 35) * r;
                    
                    valid = true; 
                }
                
                treeData.leaves.push({
                    x: lx,
                    y: ly,
                    baseX: lx, // è¨˜éŒ„åŸå§‹ä½ç½®ç”¨æ–¼æ–æ“º
                    size: 8 + Math.random() * 10,
                    targetSize: 8 + Math.random() * 10,
                    currentSize: 0, // ä¸€é–‹å§‹å¤§å°ç‚º 0
                    color: colors[Math.floor(Math.random() * colors.length)],
                    angle: Math.random() * Math.PI * 2,
                    swayOffset: Math.random() * Math.PI * 2, // æ–æ“ºç›¸ä½
                    bloomed: false
                });
            }

            // 3. æº–å‚™å¹¾æ ¹ç°¡å–®çš„æ¨¹æ (è£é£¾ç”¨ï¼Œé€£æ¥æ¨¹å¹¹å’Œè‘‰å­)
            treeData.branches.push({ x: rootX, y: rootY - treeData.trunk.maxHeight, angle: -Math.PI/2 + 0.5, len: 60 });
            treeData.branches.push({ x: rootX, y: rootY - treeData.trunk.maxHeight, angle: -Math.PI/2 - 0.5, len: 60 });
            treeData.branches.push({ x: rootX, y: rootY - treeData.trunk.maxHeight * 0.8, angle: -Math.PI/2 + 0.8, len: 50 });
            treeData.branches.push({ x: rootX, y: rootY - treeData.trunk.maxHeight * 0.8, angle: -Math.PI/2 - 0.8, len: 50 });
        }

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            // è¦–çª—æ”¹è®Šæ™‚ç°¡å–®é‡ç½®ï¼Œé¿å…è®Šå½¢
            treeData = { trunk: { height: 0, maxHeight: window.innerHeight * 0.45, width: 12 }, branches: [], leaves: [], bloomedCount: 0, finished: false };
            init();
        });

        function drawHeart(ctx, x, y, size, color, angle) {
            ctx.save();
            ctx.translate(x, y);
            ctx.rotate(angle);
            ctx.fillStyle = color;
            ctx.beginPath();
            const topCurve = size * 0.3;
            ctx.moveTo(0, 0);
            ctx.bezierCurveTo(-size / 2, -topCurve, -size, size / 3, 0, size);
            ctx.bezierCurveTo(size, size / 3, size / 2, -topCurve, 0, 0);
            ctx.fill();
            ctx.restore();
        }

        // --- å‹•ç•«è¿´åœˆ ---
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const rootX = canvas.width * 0.75;
            const rootY = canvas.height;

            // 1. ç•«æ¨¹å¹¹ (ç”Ÿé•·å‹•ç•«)
            if (treeData.trunk.height < treeData.trunk.maxHeight) {
                treeData.trunk.height += config.growSpeed;
            }
            
            // ç•«ä¸»å¹¹
            ctx.beginPath();
            ctx.moveTo(rootX, rootY);
            // å¸¶ä¸€é»é»æ›²ç·šè®“å®ƒè‡ªç„¶
            ctx.quadraticCurveTo(rootX + 10, rootY - treeData.trunk.height / 2, rootX, rootY - treeData.trunk.height);
            ctx.strokeStyle = config.trunkColor;
            ctx.lineWidth = treeData.trunk.width;
            ctx.lineCap = 'round';
            ctx.stroke();

            // 2. ç•«åˆ†æ”¯ (é…åˆæ¨¹å¹¹ç”Ÿé•·)
            if (treeData.trunk.height > treeData.trunk.maxHeight * 0.6) {
                treeData.branches.forEach(b => {
                    const progress = Math.min(1, (treeData.trunk.height - treeData.trunk.maxHeight * 0.5) / (treeData.trunk.maxHeight * 0.5));
                    if (progress > 0) {
                        const endX = b.x + Math.cos(b.angle) * b.len * progress;
                        const endY = b.y + Math.sin(b.angle) * b.len * progress;
                        ctx.beginPath();
                        ctx.moveTo(b.x, b.y);
                        ctx.lineTo(endX, endY);
                        ctx.lineWidth = treeData.trunk.width * 0.6;
                        ctx.stroke();
                    }
                });
            }

            // 3. é–‹èŠ±é‚è¼¯ (æ¨¹å¹¹é•·å®Œå¾Œé–‹å§‹)
            if (treeData.trunk.height >= treeData.trunk.maxHeight) {
                // æ¯å¹€è§£é–å¹¾ç‰‡è‘‰å­
                for (let i = 0; i < config.bloomSpeed; i++) {
                    if (treeData.bloomedCount < treeData.leaves.length) {
                        treeData.leaves[treeData.bloomedCount].bloomed = true;
                        treeData.bloomedCount++;
                    }
                }

                // é¡¯ç¤ºæ–‡å­—
                if (!treeData.finished) {
                    document.getElementById('text-container').classList.add('show-text');
                    treeData.finished = true;
                }
            }

            // 4. ç•«è‘‰å­
            const time = Date.now() * 0.002; // ç”¨æ–¼æ–æ“ºçš„æ™‚é–“åƒæ•¸
            treeData.leaves.forEach(leaf => {
                if (leaf.bloomed) {
                    // ç”Ÿé•·ç‰¹æ•ˆï¼šå¾ 0 è®Šå¤§åˆ°ç›®æ¨™å¤§å°
                    if (leaf.currentSize < leaf.targetSize) {
                        leaf.currentSize += 0.5;
                    }
                    
                    // é¢¨å¹æ–æ“ºæ•ˆæœ
                    const sway = Math.sin(time + leaf.swayOffset) * 3;
                    
                    drawHeart(ctx, leaf.x + sway, leaf.y, leaf.currentSize, leaf.color, leaf.angle + sway * 0.05);
                }
            });

            requestAnimationFrame(animate);
        }

        // å•Ÿå‹•
        init();
        animate();

    </script>
</body>
</html>